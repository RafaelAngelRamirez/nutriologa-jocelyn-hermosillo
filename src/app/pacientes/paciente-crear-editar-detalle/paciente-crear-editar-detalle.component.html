<div *ngIf="formulario" class="row mt-3 para-detalle">
  <div class="col-12">
    <div class="card shadow">
      <div class="card-body">
        <form [formGroup]="formulario">
          <div class="row">
            <ng-container *ngIf="false; else botonGuardado"></ng-container>
            <!-- 
=====================================
 nombre
=====================================
-->
            <div class="col-12 col-md-6 col-lg-4">
              <div class="form-group">
                <input
                  [ngClass]="{
                    'is-invalid': vs.invalid(f('nombre')),
                    'is-valid': vs.valid(f('nombre'))
                  }"
                  type="text"
                  class="form-control"
                  formControlName="nombre"
                />
                <small id="helpId" class="form-text text-muted">Nombre</small>
                <app-validacion-inputs
                  [campo]="f('nombre')"
                ></app-validacion-inputs>
              </div>
            </div>
            <!-- 
=====================================
 END nombre
=====================================
-->

            <!-- 
=====================================
 fechaDeNacimiento
=====================================
-->
            <div class="col-12 col-md-6 col-lg-4">
              <div class="form-group">
                <input
                  [ngClass]="{
                    'is-invalid': vs.invalid(f('fechaDeNacimiento')),
                    'is-valid': vs.valid(f('fechaDeNacimiento'))
                  }"
                  type="date"
                  class="form-control"
                  formControlName="fechaDeNacimiento"
                />
                <small id="helpId" class="form-text text-muted"
                  >Fecha de nacimiento. Edad
                  {{
                    utilidadesService.calcularEdad(f("fechaDeNacimiento").value)
                  }}
                  años
                </small>
                <app-validacion-inputs
                  [campo]="f('fechaDeNacimiento')"
                ></app-validacion-inputs>
              </div>
            </div>
            <!-- 
=====================================
 END fechaDeNacimiento
=====================================
-->

            <!-- 
=====================================
 celular
=====================================
-->
            <div class="col-12 col-md-6 col-lg-4">
              <div class="form-group">
                <input
                  [ngClass]="{
                    'is-invalid': vs.invalid(f('celular')),
                    'is-valid': vs.valid(f('celular'))
                  }"
                  type="text"
                  class="form-control"
                  formControlName="celular"
                />
                <small id="helpId" class="form-text text-muted">Celular</small>
                <app-validacion-inputs
                  [campo]="f('celular')"
                ></app-validacion-inputs>
              </div>
            </div>
            <!-- 
=====================================
 END celular
=====================================
-->

            <!-- 
=====================================
 sexo
=====================================
-->
            <div class="col-12 col-md-6 col-lg-4">
              <div class="form-group">
                <select
                  [ngClass]="{
                    'is-invalid': vs.invalid(f('sexo')),
                    'is-valid': vs.valid(f('sexo'))
                  }"
                  formControlName="sexo"
                  class="form-control"
                >
                  <option [ngValue]="true" selected>Mujer</option>
                  <option [ngValue]="false">Hombre</option>
                </select>
                <small id="helpId" class="form-text text-muted">Sexo</small>
                <app-validacion-inputs
                  [campo]="f('sexo')"
                ></app-validacion-inputs>
              </div>
            </div>
            <!-- 
=====================================
 END sexo
=====================================
-->

            <!-- 
=====================================
 Array metasDelPaciente 
=====================================
-->
            <div class="col-12">
              <hr />
              <h3>Metas</h3>
            </div>
            <ng-container formArrayName="metasDelPaciente">
              <ng-container
                *ngFor="
                  let dummy of fa('metasDelPaciente').controls;
                  let i = index
                "
              >
                <ng-container [formGroupName]="i">
                  <!-- 
    =====================================
     metasDelPaciente
    =====================================
    -->
                  <div class="col-12">
                    <div class="form-group">
                      <small
                        id="helpId"
                        class="form-text text-muted d-flex justify-content-between"
                        >Meta #{{ i + 1 }}

                        <a
                          class="text-danger"
                          href="javascript:void(0)"
                          *ngIf="!esDetalle"
                          (click)="fa('metasDelPaciente').removeAt(i)"
                        >
                          Eliminar meta
                        </a>
                      </small>
                      <input
                        [ngClass]="{
                          'is-invalid': vs.invalid(dummy),
                          'is-valid': vs.valid(dummy)
                        }"
                        type="text"
                        class="form-control"
                        [formControl]="dummy"
                      />
                      <app-validacion-inputs
                        [campo]="dummy"
                        [directo]="true"
                      ></app-validacion-inputs>
                    </div>
                  </div>
                  <!-- 
    =====================================
     END metasDelPaciente
    =====================================
    -->
                </ng-container>
              </ng-container>
            </ng-container>

            <div class="col-12 mt-3">
              <a
                *ngIf="!esDetalle"
                (click)="agregarMeta()"
                class="btn btn-primary"
                href="javascript:void(0)"
                role="button"
                >Agregar meta</a
              >
            </div>
            <!-- 
=====================================
 END Array metasDelPaciente 
=====================================
-->
            <div class="col-12">
              <hr />
              <h3>Condicion actual</h3>
            </div>

            <ng-container formGroupName="condicionActual">
              <!-- 
              =====================================
               embarazo
              =====================================
              -->
              <div class="col-12 col-md-6 col-lg-4">
                <div class="form-check">
                  <label class="form-check-label">
                    <input
                      type="checkbox"
                      class="form-check-input"
                      formControlName="embarazo"
                    />
                    Embarazo
                  </label>
                </div>
              </div>
              <!-- 
              =====================================
               END embarazo
              =====================================
              -->

              <!-- 
              =====================================
               dm
              =====================================
              -->
              <div class="col-12 col-md-6 col-lg-4">
                <div class="form-check">
                  <label class="form-check-label">
                    <input
                      type="checkbox"
                      class="form-check-input"
                      formControlName="dm"
                    />
                    DM
                  </label>
                </div>
              </div>
              <!-- 
              =====================================
               END dm
              =====================================
              -->

              <!-- 
              =====================================
               ht
              =====================================
              -->
              <div class="col-12 col-md-6 col-lg-4">
                <div class="form-check">
                  <label class="form-check-label">
                    <input
                      type="checkbox"
                      class="form-check-input"
                      formControlName="ht"
                    />
                    HT
                  </label>
                </div>
              </div>
              <!-- 
              =====================================
               END ht
              =====================================
              -->

              <!-- 
              =====================================
               dl
              =====================================
              -->
              <div class="col-12 col-md-6 col-lg-4">
                <div class="form-check">
                  <label class="form-check-label">
                    <input
                      type="checkbox"
                      class="form-check-input"
                      formControlName="dl"
                    />
                    DL
                  </label>
                </div>
              </div>
              <!-- 
              =====================================
               END dl
              =====================================
              -->

              <!-- 
              =====================================
               au
              =====================================
              -->
              <div class="col-12 col-md-6 col-lg-4">
                <div class="form-check">
                  <label class="form-check-label">
                    <input
                      type="checkbox"
                      class="form-check-input"
                      formControlName="au"
                    />
                    AU
                  </label>
                </div>
              </div>
              <!-- 
              =====================================
               END au
              =====================================
              -->

              <!-- 
              =====================================
               ca
              =====================================
              -->
              <div class="col-12 col-md-6 col-lg-4">
                <div class="form-check">
                  <label class="form-check-label">
                    <input
                      type="checkbox"
                      class="form-check-input"
                      formControlName="ca"
                    />
                    CA
                  </label>
                </div>
              </div>
              <!-- 
              =====================================
               END ca
              =====================================
              -->

              <!-- 
              =====================================
               cv
              =====================================
              -->
              <div class="col-12 col-md-6 col-lg-4">
                <div class="form-check">
                  <label class="form-check-label">
                    <input
                      type="checkbox"
                      class="form-check-input"
                      formControlName="cv"
                    />
                    CV
                  </label>
                </div>
              </div>
              <!-- 
              =====================================
               END cv
              =====================================
              -->

              <!-- 
              =====================================
               otra
              =====================================
              -->
              <div class="col-12 col-md-6">
                <div class="form-group">
                  <input
                    [ngClass]="{
                      'is-invalid': vs.invalid(f('condicionActual.otra')),
                      'is-valid': vs.valid(f('condicionActual.otra'))
                    }"
                    type="text"
                    class="form-control"
                    formControlName="otra"
                  />
                  <small id="helpId" class="form-text text-muted">Otra</small>
                  <app-validacion-inputs
                    [campo]="f('condicionActual.otra')"
                  ></app-validacion-inputs>
                </div>
              </div>
              <!-- 
              =====================================
               END otra
              =====================================
              -->

              <ng-container formGroupName="problemasGastroIntestinales">
                <div class="col-12">
                  <hr />
                  <h3>Problemas Gastrointestinales</h3>
                </div>

                <!-- 
                =====================================
                 estrenimiento
                =====================================
                -->
                <div class="col-6">
                  <div class="form-check">
                    <label class="form-check-label">
                      <input
                        type="checkbox"
                        class="form-check-input"
                        formControlName="estrenimiento"
                      />
                      Estreñimiento
                    </label>
                  </div>
                </div>
                <!-- 
                =====================================
                 END estrenimiento
                =====================================
                -->

                <!-- 
                =====================================
                 diarrea
                =====================================
                -->
                <div class="col-6">
                  <div class="form-check">
                    <label class="form-check-label">
                      <input
                        type="checkbox"
                        class="form-check-input"
                        formControlName="diarrea"
                      />
                      Diarrea
                    </label>
                  </div>
                </div>
                <!-- 
                =====================================
                 END diarrea
                =====================================
                -->

                <!-- 
                =====================================
                 alergias
                =====================================
                -->
                <div class="col-6">
                  <div class="form-check">
                    <label class="form-check-label">
                      <input
                        type="checkbox"
                        class="form-check-input"
                        formControlName="alergias"
                      />
                      Alergias
                    </label>
                  </div>
                </div>
                <!-- 
                =====================================
                 END alergias
                =====================================
                -->

                <!-- 
                =====================================
                 vomito
                =====================================
                -->
                <div class="col-6">
                  <div class="form-check">
                    <label class="form-check-label">
                      <input
                        type="checkbox"
                        class="form-check-input"
                        formControlName="vomito"
                      />
                      Vomito
                    </label>
                  </div>
                </div>
                <!-- 
                =====================================
                 END vomito
                =====================================
                -->

                <!-- 
                =====================================
                 colitis
                =====================================
                -->
                <div class="col-6">
                  <div class="form-check">
                    <label class="form-check-label">
                      <input
                        type="checkbox"
                        class="form-check-input"
                        formControlName="colitis"
                      />
                      Colitis
                    </label>
                  </div>
                </div>
                <!-- 
                =====================================
                 END colitis
                =====================================
                -->

                <!-- 
                =====================================
                 gastritis
                =====================================
                -->
                <div class="col-6">
                  <div class="form-check">
                    <label class="form-check-label">
                      <input
                        type="checkbox"
                        class="form-check-input"
                        formControlName="gastritis"
                      />
                      Gastritis
                    </label>
                  </div>
                </div>
                <!-- 
                =====================================
                 END gastritis
                =====================================
                -->

                <!-- 
                =====================================
                 nauseas
                =====================================
                -->
                <div class="col-6">
                  <div class="form-check">
                    <label class="form-check-label">
                      <input
                        type="checkbox"
                        class="form-check-input"
                        formControlName="nauseas"
                      />
                      Nauseas
                    </label>
                  </div>
                </div>
                <!-- 
                =====================================
                 END nauseas
                =====================================
                -->

                <!-- 
                =====================================
                 agruras
                =====================================
                -->
                <div class="col-6">
                  <div class="form-check">
                    <label class="form-check-label">
                      <input
                        type="checkbox"
                        class="form-check-input"
                        formControlName="agruras"
                      />
                      Agruras
                    </label>
                  </div>
                </div>
                <!-- 
                =====================================
                 END agruras
                =====================================
                -->

                <!-- 
                =====================================
                 distencionAbdominal
                =====================================
                -->
                <div class="col-6">
                  <div class="form-check">
                    <label class="form-check-label">
                      <input
                        type="checkbox"
                        class="form-check-input"
                        formControlName="distencionAbdominal"
                      />
                      Distención abdominal
                    </label>
                  </div>
                </div>
                <!-- 
                =====================================
                 END distencionAbdominal
                =====================================
                -->

                <!-- 
                =====================================
                 otro
                =====================================
                -->
                <div class="col-6">
                  <div class="form-group">
                    <input
                      [ngClass]="{
                        'is-invalid': vs.invalid(
                          f('condicionActual.problemasGastroIntestinales.otro')
                        ),
                        'is-valid': vs.valid(
                          f('condicionActual.problemasGastroIntestinales.otro')
                        )
                      }"
                      type="text"
                      class="form-control"
                      formControlName="otro"
                    />
                    <small id="helpId" class="form-text text-muted">Otro</small>
                    <app-validacion-inputs
                      [campo]="
                        f('condicionActual.problemasGastroIntestinales.otro')
                      "
                    ></app-validacion-inputs>
                  </div>
                </div>
                <!-- 
                =====================================
                 END otro
                =====================================
                -->
              </ng-container>
            </ng-container>

            <ng-container *ngIf="false; else botonGuardado"></ng-container>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<ng-template #botonGuardado>
  <div *ngIf="!esDetalle" class="col-12">
    <hr />
    <a
      (click)="submit(formulario?.value, formulario.invalid)"
      class="btn btn-success"
      href="javascript:void(0)"
      role="button"
    >
      Guardar</a
    >
  </div>
  <div *ngIf="esDetalle" class="col-12">
    <hr />
    <a class="btn btn-primary" role="button" (click)="modificar(paciente)">
      Editar
    </a>
  </div>
</ng-template>
